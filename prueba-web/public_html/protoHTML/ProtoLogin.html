<!DOCTYPE html>

<html>
    <head>
        <meta charset="UTF-8">
        <title>Inicio</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <link href='https://fonts.googleapis.com/css?family=Hammersmith+One' rel='stylesheet' type='text/css'>
        <link href="../CSS/Estilo-Login.css" rel="stylesheet" type="text/css"/>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
        <script src="https://www.gstatic.com/firebasejs/3.9.0/firebase.js"></script>
    <script src="frConfig.js"></script>
    <script>
        
            // Initialize Firebase
          /*var config = {
            apiKey: "AIzaSyAuSjFHm2l6wBMdAtj-BTRor27Hnn_4Tns",
            authDomain: "prueba-web-630ea.firebaseapp.com",
            databaseURL: "https://prueba-web-630ea.firebaseio.com",
            projectId: "prueba-web-630ea",
            storageBucket: "",
            messagingSenderId: "322979248019"
          };
          firebase.initializeApp(config);*/
          
          firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
              console.log(user);
              location.href="Portada.html";
            } else {
              console.log('not logged in');
            }
          });
        
          /*const txtEmail = document.getElementById('usuario');
          const txtPassword = document.getElementById('password');
          const btnLogin = document.getElementById('iniciar');
          
          btnLogin.addEventListener('click', e => {
             //get email and pass
             const email = txtEmail.value;
             const pass = txtPassword.value;
             const auth = firebase.auth();
             //Sign in
             const promise = auth.signInWithEmailAndPassword(email, pass);
             promise.catch(e => console.log(e, "Error basico"));
          });*/
        
        function comprobar(){
            var usu = $('#usuario').val();
            var con = $('#password').val();

            if(con == "" || usu == ""){
                alert("Debe rellenar todos los campos");
            }else{
                if(!usu.match("^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$")){
                    alert("El email no es valido");
                }else{
                    var promise = firebase.auth().signInWithEmailAndPassword(usu, con).catch(function(error) {
                      // Handle Errors here.
                      var errorCode = error.code;
                      var errorMessage = error.message;
                      // ...
                    });
                }
            }
        }
        
        
    </script>
    </head> 
    
    <body>       
        <div class="ini">
            <form>
                <input type="text" class="inicio" name="usuario" placeholder="Usuario" id='usuario' value=""/>
                <input type="password" class="inicio" name="password" placeholder="Contraseña" id='password' value=""/>
                <input type="button" id="iniciar" onclick="comprobar()" value="Iniciar Sesión"/>
                <a id="en" href="Registro.html">Registrate gratis</a>
            </form>
        </div>
        
    </body>
</html>

